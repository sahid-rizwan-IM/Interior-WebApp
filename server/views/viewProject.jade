extends layout
block head
    link(rel="stylesheet" href="/css/projectList.css")
    link(rel="stylesheet" href="/css/addNewProject.css")
    link(rel="stylesheet" href="/css/viewProject.css")
    link(rel="stylesheet", href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css")

block content
    input#viewedProject(type="hidden" name="viewedProject" value=JSON.stringify(currentProjectDetails))
    input#materialList(type="hidden" name="materialList" value=JSON.stringify(materialList))
    section
        .headerBox
            .row
                -console.log("got all", currentProjectDetails)
                h4 #{currentProjectDetails ? currentProjectDetails.projectName : ''} - Material Lists
                    span.h3Details (Client Name: #{currentProjectDetails ? currentProjectDetails.clientName : ''} - Quoted Amount: #{currentProjectDetails ? currentProjectDetails.totalAmount : ''})
                    a.logout(onclick="openLogoutModal()") Logout
                    a.addNewProject(onclick="addItemsModal()") Add Items
        .table-main.custom-pagination(style="margin-top: 3rem;background:grey")
            table.table.table-striped.table-bordered.dataTable(id="materialListTable" cellpadding='0' cellspacing='0' border='0' width='100%' style="border-right-width: 1px !important;")
        .project-list 
        //- Custom modal
        div#logoutModal.modal-overlay(style="display:none !important")
        div#addItemsModal.modal-overlay(style="display:none !important")

    script(src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js")
    script(src='/static/js/jquery.dataTables.min.js')
    script(src='https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js')
    script(src="/static/datatables-bs4/js/dataTables.bootstrap4.min.js")
    script(src='/js/adminLogin.js')
    script(src='/js/viewProject.js')
    script(src='/js/bootstrap/bootstrap-notify.min.js' async)

    script.
        $(document).ready(function () {
            var materialList = JSON.parse($('#materialList').val());
            //- var userId = $('#userId').val();
            //- const statusEnum = JSON.parse($('#statusenum').val());
            
            var materialListColumns = [
                { "sTitle": "Material Name", "mData": "materialName", "sWidth": "20%" },
                { "sTitle": "Quantity", "mData": "totalQuantity", "sWidth": "20%" },
                { "sTitle": "Used Count", "mData": "usedCount", "sWidth": "20%" },
                { "sTitle": "Balance Count", "mData": "balanceCount", "sWidth": "20%" },
                {
                    "sTitle": "Action",
                    "sClass": "center text-center editMemoryBookRow",
                    "bSortable": false,
                    "bSearchable": false,
                    "mData": "_id",
                    "sWidth": "20%",
                    "mRender": function (data, type, row) {
                        var editUrl = `/api/addMaterial/${data}`;
                        return `<a href="${editUrl}" title="Edit Memory Book">` +
                            `<i class="fa fa-pencil-square-o fa-lg" aria-hidden="true"></i></a>`;
                    }
                }
            ];

            $('#materialListTable').removeAttr('width').dataTable({
                "searching": true,
                'autoWidth': false,
                "paging": true,
                "bFilter": false,
                "info": false,
                "aaData": materialList,
                "ordering": false,
                "aoColumns": materialListColumns,
                //- 'columnDefs': [
                //-     {
                //-         "targets": [5, 6],
                //-         "className": "text-center",
                //-     },
                //-     {
                //-         "targets": 2,
                //-         "className": "mbUsers",
                //-     }
                //- ],
                stateSave: true,
                preDrawCallback: function () { },
                rowCallback: function (nRow) { },
                drawCallback: function (oSettings) { }
            });
        });
